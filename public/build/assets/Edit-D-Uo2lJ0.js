import{K as X,m as Y,r as w,j as e,L as Z,$ as ee}from"./app-BaJ1uPEp.js";import{_ as i}from"./translate-B-pR72aC.js";import{A as se}from"./app-layout-BENjltLq.js";import{B as E}from"./button-CV0YeMoG.js";import{I as p}from"./input-DvQox4_7.js";import{L as n}from"./label-ClSqAyBn.js";import{T as k}from"./textarea-C1DlFSfo.js";import{C as f,a as v,b as N,c as y,d as S}from"./card-Dn7YJrue.js";import{T as ie,a as te,b,c as C}from"./tabs-B-GsCbyv.js";import{S as A}from"./switch-7o53iedf.js";import{S as ae,a as re,b as le,c as ne,d as de}from"./select-Clb-v8H6.js";import{I as ce}from"./image-uploader-DKYPIYIv.js";import{C as G}from"./checkbox-DCedZhAq.js";import{R as oe,a as me}from"./radio-group-X6188t3G.js";import{H as he}from"./heading-small-Zqr3Ozqi.js";import{I as m}from"./input-error-Bf6YyRFA.js";import{D as pe,a as ue,b as ge,c as R}from"./sonner-B_1Y2EG6.js";import{T as q}from"./trash-2-Bv5dJqvN.js";import"./index-4ejw1QIu.js";import"./index-BZHxc9Pz.js";import"./index-DKM3Rv-a.js";import"./app-logo-icon-zBgZ3COU.js";import"./list-DuKmuFCx.js";import"./store-BbRIbGy8.js";import"./breadcrumb-BbD90ndO.js";import"./chevron-right-DEcAd_h2.js";import"./index-PXdSJRW8.js";import"./index-zkgesfvN.js";import"./chevron-down-ClUYmTxr.js";import"./PencilIcon-OdtUYhBh.js";function Ke({product:a,catalogues:U,stores:g,attributes:F,productAttributes:T}){var M;const{auth:P}=X().props,$=P.user&&P.user.is_admin,{data:r,setData:l,post:O,processing:D,errors:c}=Y({title:a.title||"",sku:a.sku||"",description:a.description||"",content:a.content||"",price:a.price.toString()||"",sale_price:a.sale_price?a.sale_price.toString():"",stock_quantity:a.stock_quantity.toString()||"0",catalogue_id:a.catalogue_id?a.catalogue_id.toString():"",catalogue_ids:a.catalogues?a.catalogues.map(s=>s.id.toString()):[],store_id:a.store_id?a.store_id.toString():"",is_active:a.is_active,is_featured:a.is_featured,meta_title:a.meta_title||"",meta_description:a.meta_description||"",thumbnail:null,gallery:[],attributes:{},_method:"PUT"}),[h,I]=w.useState([]),[x,B]=w.useState(a.gallery||[]),[L,V]=w.useState(a.content||"");w.useEffect(()=>{if(T){let s={};Object.entries(T).forEach(([t,o])=>{const d=F.find(u=>u.id===parseInt(t));d&&(d.type==="multiselect"?s[parseInt(t)]=o.split(","):s[parseInt(t)]=o)}),l("attributes",s)}},[T]);const H=[{title:i("admin.products","Products"),href:route("products.index")},{title:a.title,href:route("products.edit",a.id)}],K=s=>{s.preventDefault(),L&&l("content",L),O(route("products.update",a.id),{forceFormData:!0})},z=s=>{I([...h,...s]),l("gallery",[...h,...s])},j=(s,t)=>{l("attributes",{...r.attributes,[s]:t})},J=async s=>{var t;if(confirm("Are you sure you want to delete this image?"))try{const d=await(await fetch(route("products.delete-media",a.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({media_id:s})})).json();d.success?B(x.filter(u=>u.id!==s)):alert("Failed to delete image: "+(d.message||"Unknown error"))}catch(o){console.error("Error deleting image:",o),alert("Failed to delete image")}},Q=s=>{const t=[...h];t.splice(s,1),I(t),l("gallery",t)};return e.jsxs(se,{breadcrumbs:H,children:[e.jsx(Z,{title:`${i("admin.edit_product","Edit Product")}: ${a.title}`}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(he,{title:`${i("admin.edit_product","Edit Product")}: ${a.title}`,description:i("admin.edit_product_description","Update product information")})}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs(ie,{defaultValue:"general",className:"w-full",children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(b,{value:"general",children:i("admin.general","General")}),e.jsx(b,{value:"data",children:i("admin.data","Data")}),e.jsx(b,{value:"media",children:i("admin.media","Media")}),e.jsx(b,{value:"attributes",children:i("admin.attributes","Attributes")}),e.jsx(b,{value:"seo",children:i("admin.seo","SEO")})]}),e.jsx(C,{value:"general",children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:i("admin.general_information","General Information")}),e.jsx(y,{children:i("admin.general_information_description","Basic product information")})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"title",children:[i("admin.product_title","Product Title")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(p,{id:"title",value:r.title,onChange:s=>l("title",s.target.value),placeholder:i("admin.product_title_placeholder","Enter product title")}),e.jsx(m,{message:c.title})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"slug",children:i("admin.slug","Slug")}),e.jsx(p,{id:"slug",value:a.slug,disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i("admin.slug_auto_generated","Slug is auto-generated and cannot be changed")})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"sku",children:i("admin.sku","SKU")}),e.jsx(p,{id:"sku",value:r.sku,onChange:s=>l("sku",s.target.value),placeholder:i("admin.sku_placeholder","Product Stock Keeping Unit")}),e.jsx(m,{message:c.sku})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"description",children:i("admin.short_description","Short Description")}),e.jsx(k,{id:"description",value:r.description,onChange:s=>l("description",s.target.value),placeholder:i("admin.short_description_placeholder","Brief description for product listings"),rows:3}),e.jsx(m,{message:c.description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"content",children:i("admin.full_description","Full Description")}),e.jsx(k,{id:"content",value:r.content,onChange:s=>{l("content",s.target.value),V(s.target.value)},placeholder:i("admin.full_description_placeholder","Detailed product description"),rows:6}),e.jsx(m,{message:c.content})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"catalogue_id",children:[i("admin.catalogue","Catalogue")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("div",{className:"border rounded-md p-4 max-h-[300px] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:U.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{id:`catalogue-${s.id}`,checked:r.catalogue_ids.includes(s.id.toString()),onCheckedChange:t=>{const o=!!t;let d=[...r.catalogue_ids];o?(d.push(s.id.toString()),r.catalogue_id===""&&l("catalogue_id",s.id.toString())):(d=d.filter(u=>u!==s.id.toString()),r.catalogue_id===s.id.toString()&&d.length>0?l("catalogue_id",d[0]):d.length===0&&l("catalogue_id","")),l("catalogue_ids",d)}}),e.jsx(n,{htmlFor:`catalogue-${s.id}`,children:s.name})]},s.id))})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:i("admin.select_multiple_catalogues","Select one or more catalogues for this product")}),e.jsx(m,{message:c.catalogue_ids||c.catalogue_id})]}),g.length>0&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"store_id",children:i("admin.store","Store")}),e.jsxs(pe,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"w-full justify-between",disabled:!$&&g.length===1,children:[r.store_id?(M=g.find(s=>s.id.toString()===r.store_id))==null?void 0:M.name:i("admin.select_store","Select store"),e.jsx("svg",{className:"h-4 w-4 opacity-50",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"})})]})}),$&&e.jsxs(ge,{align:"center",className:"w-[300px]",children:[g.length>1&&e.jsx(R,{onClick:()=>l("store_id",""),children:i("admin.none","None")}),g.map(s=>e.jsx(R,{onClick:()=>l("store_id",s.id.toString()),children:s.name},s.id))]})]}),!$&&g.length===1&&e.jsx("p",{className:"text-sm text-muted-foreground",children:i("admin.store_fixed","Products can only be assigned to your store")}),e.jsx(m,{message:c.store_id})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"is_active",checked:r.is_active,onCheckedChange:s=>l("is_active",s)}),e.jsx(n,{htmlFor:"is_active",children:i("admin.is_active","Active")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"is_featured",checked:r.is_featured,onCheckedChange:s=>l("is_featured",s)}),e.jsx(n,{htmlFor:"is_featured",children:i("admin.is_featured","Featured Product")})]})]})]})}),e.jsx(C,{value:"data",children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:i("admin.product_data","Product Data")}),e.jsx(y,{children:i("admin.product_data_description","Price and inventory information")})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"price",children:[i("admin.price","Price")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(p,{id:"price",type:"number",min:"0",step:"0.01",value:r.price,onChange:s=>l("price",s.target.value),placeholder:"0.00"}),e.jsx(m,{message:c.price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"sale_price",children:i("admin.sale_price","Sale Price")}),e.jsx(p,{id:"sale_price",type:"number",min:"0",step:"0.01",value:r.sale_price,onChange:s=>l("sale_price",s.target.value),placeholder:"0.00"}),e.jsx(m,{message:c.sale_price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(n,{htmlFor:"stock_quantity",children:[i("admin.stock_quantity","Stock Quantity")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(p,{id:"stock_quantity",type:"number",min:"0",step:"1",value:r.stock_quantity,onChange:s=>l("stock_quantity",s.target.value),placeholder:"0"}),e.jsx(m,{message:c.stock_quantity})]})]})]})}),e.jsx(C,{value:"media",children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:i("admin.product_media","Product Media")}),e.jsx(y,{children:i("admin.product_media_description","Product images and gallery")})]}),e.jsxs(S,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(n,{children:i("admin.thumbnail","Thumbnail Image")}),e.jsx(ce,{id:"thumbnail",onChange:s=>l("thumbnail",s),value:a.thumbnail,title:i("admin.thumbnail_image","Thumbnail Image"),description:i("admin.thumbnail_description","Main product image"),error:c.thumbnail,helpText:i("admin.image_help_text","Recommended size: 800x800px, Max 2MB"),placeholder:"/assets/placeholders/product.png",className:"w-full h-60",previewClassName:"w-full h-60 object-contain"})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between",children:[e.jsx(n,{children:i("admin.gallery","Product Gallery")}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[x.length+h.length," / 8 ",i("admin.images","images")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[x.map(s=>e.jsxs("div",{className:"relative border rounded-md overflow-hidden",children:[e.jsx("img",{src:s.url,alt:s.name,className:"w-full h-32 object-cover"}),e.jsx("button",{type:"button",className:"absolute top-2 right-2 bg-destructive text-white p-1 rounded-full",onClick:()=>J(s.id),children:e.jsx(q,{className:"h-4 w-4"})})]},s.id)),h.map((s,t)=>e.jsxs("div",{className:"relative border rounded-md overflow-hidden",children:[e.jsx("img",{src:URL.createObjectURL(s),alt:`New gallery image ${t+1}`,className:"w-full h-32 object-cover"}),e.jsx("button",{type:"button",className:"absolute top-2 right-2 bg-destructive text-white p-1 rounded-full",onClick:()=>Q(t),children:e.jsx(q,{className:"h-4 w-4"})})]},`new-${t}`)),x.length+h.length<8&&e.jsxs("div",{className:"border-2 border-dashed rounded-md p-6 flex flex-col items-center justify-center cursor-pointer hover:border-primary/50",children:[e.jsx("input",{type:"file",id:"gallery",multiple:!0,className:"hidden",accept:"image/*",onChange:s=>{if(s.target.files){const t=Array.from(s.target.files),o=8-(x.length+h.length),d=t.slice(0,o);z(d)}}}),e.jsx(n,{htmlFor:"gallery",className:"cursor-pointer text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx("svg",{className:"w-6 h-6 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e.jsx("span",{className:"text-sm font-medium",children:i("admin.add_images","Add Images")}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i("admin.up_to_n_images","Up to {count} images, max 2MB each").replace("{count}",(8-(x.length+h.length)).toString())})]})})]})]}),e.jsx(m,{message:c.gallery})]})]})]})}),e.jsx(C,{value:"attributes",children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:i("admin.product_attributes","Product Attributes")}),e.jsx(y,{children:i("admin.product_attributes_description","Define product specifications and features")})]}),e.jsx(S,{children:e.jsx("div",{className:"space-y-6",children:F.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:i("admin.no_attributes_defined","No attributes have been defined yet.")}):F.map(s=>e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsxs("h3",{className:"font-medium mb-2",children:[s.name,s.is_required&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.type==="text"&&e.jsx(p,{placeholder:`Enter ${s.name.toLowerCase()}`,value:r.attributes[s.id]||"",onChange:t=>j(s.id,t.target.value)}),s.type==="textarea"&&e.jsx(k,{placeholder:`Enter ${s.name.toLowerCase()}`,value:r.attributes[s.id]||"",onChange:t=>j(s.id,t.target.value),rows:3}),s.type==="select"&&e.jsxs(ae,{value:r.attributes[s.id]||"",onValueChange:t=>j(s.id,t),children:[e.jsx(re,{children:e.jsx(le,{placeholder:`Select ${s.name.toLowerCase()}`})}),e.jsx(ne,{children:s.values.map(t=>e.jsx(de,{value:t.id.toString(),children:t.value},t.id))})]}),s.type==="multiselect"&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.values.map(t=>{const o=r.attributes[s.id]||[],d=o.includes(t.id.toString());return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{id:`attr-${s.id}-${t.id}`,checked:d,onCheckedChange:u=>{let _=[...o];u?_.includes(t.id.toString())||_.push(t.id.toString()):_=_.filter(W=>W!==t.id.toString()),j(s.id,_)}}),e.jsx(n,{htmlFor:`attr-${s.id}-${t.id}`,children:t.value})]},t.id)})}),s.type==="radio"&&e.jsx(oe,{value:r.attributes[s.id]||"",onValueChange:t=>j(s.id,t),children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.values.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(me,{value:t.id.toString(),id:`attr-${s.id}-${t.id}`}),e.jsx(n,{htmlFor:`attr-${s.id}-${t.id}`,children:t.value})]},t.id))})})]},s.id))})})]})}),e.jsx(C,{value:"seo",children:e.jsxs(f,{children:[e.jsxs(v,{children:[e.jsx(N,{children:i("admin.seo_information","SEO Information")}),e.jsx(y,{children:i("admin.seo_information_description","Search engine optimization details")})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"meta_title",children:i("admin.meta_title","Meta Title")}),e.jsx(p,{id:"meta_title",value:r.meta_title,onChange:s=>l("meta_title",s.target.value),placeholder:i("admin.meta_title_placeholder","SEO meta title")}),e.jsx(m,{message:c.meta_title})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"meta_description",children:i("admin.meta_description","Meta Description")}),e.jsx(k,{id:"meta_description",value:r.meta_description,onChange:s=>l("meta_description",s.target.value),placeholder:i("admin.meta_description_placeholder","SEO meta description"),rows:3}),e.jsx(m,{message:c.meta_description})]})]})]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{type:"submit",disabled:D,children:D?i("admin.saving","Saving..."):i("admin.save_product","Save Product")}),e.jsx(ee,{href:route("products.index"),children:e.jsx(E,{variant:"outline",type:"button",children:i("admin.cancel","Cancel")})})]})]})]})]})}export{Ke as default};
