import{r as d,j as e,L as de,$ as oe,S as j}from"./app-DHNzh_VC.js";import{A as me}from"./app-layout-BAyZncYX.js";import{B as h}from"./button-B2oyIXXl.js";import{I as o}from"./input-CnmXs62P.js";import{T as D}from"./textarea-BY9VE5Mk.js";import{C as E,a as L,b as O,c as H,d as M,e as he}from"./card-LNnVeNUF.js";import{L as r}from"./label-DWQfPYVq.js";import{S}from"./switch-2X_EHrlM.js";import{D as R,f as ue,a as P,b as U,c as $,d as B,e as K}from"./dialog-jzrNF0rD.js";import{D as pe,a as xe,b as ge,c as V}from"./sonner-Cr_jOxrZ.js";import{B as je}from"./badge-CsRqFO5U.js";import{T as ve,a as fe,b as A,c as z}from"./tabs-4HD461Ia.js";import{H as Ne}from"./heading-small-CHrM6-yQ.js";import{F as be}from"./ArrowLeftIcon-Bj_drGa6.js";import{F as Q}from"./PlusIcon-DK_RvV3E.js";import{E as _e}from"./ellipsis-vertical-C8u4WEG6.js";import"./index-BQKTQ84O.js";import"./index-1DmtFonr.js";import"./index-DY0_e_T1.js";import"./app-logo-icon-B9DC4l8N.js";import"./list-BNhG1I-Q.js";import"./store-NKSfwcvQ.js";import"./breadcrumb-BhwNYiCZ.js";import"./chevron-right-BLAdJ8Ar.js";import"./index-Dctsv1RR.js";import"./index-B2-qcrAV.js";function Ge({slider:c}){const[p,I]=d.useState({name:c.name,slug:c.slug,description:c.description||"",is_active:c.is_active}),[m,q]=d.useState({}),[F,w]=d.useState(!1),[v,x]=d.useState(c.items),[l,f]=d.useState({title:"",description:"",button_text:"",button_url:"",is_active:!0,image:null,imagePreview:""}),[i,u]=d.useState(null),[X,N]=d.useState(!1),[G,b]=d.useState(!1),[g,T]=d.useState(null),[y,k]=d.useState(null);d.useEffect(()=>{x(c.items)},[c.items]);const C=s=>{const{name:t,value:n}=s.target;I(a=>({...a,[t]:n}))},J=s=>{I(t=>({...t,is_active:s}))},W=s=>{s.preventDefault(),w(!0),j.put(route("sliders.update",c.id),p,{onSuccess:()=>{w(!1)},onError:t=>{q(t),w(!1)}})},_=s=>{const{name:t,value:n}=s.target;f(a=>({...a,[t]:n}))},Y=s=>{f(t=>({...t,is_active:s}))},Z=s=>{var n;const t=((n=s.target.files)==null?void 0:n[0])||null;t&&f(a=>({...a,image:t,imagePreview:URL.createObjectURL(t)}))},ee=()=>{const s=new FormData;s.append("title",l.title),s.append("description",l.description),s.append("button_text",l.button_text),s.append("button_url",l.button_url),s.append("is_active",l.is_active?"1":"0"),l.image&&s.append("image",l.image),j.post(route("slider-items.store",c.id),s,{onSuccess:t=>{var a;const n=t;(a=n.props.slider)!=null&&a.items&&x(n.props.slider.items),f({title:"",description:"",button_text:"",button_url:"",is_active:!0,image:null,imagePreview:""}),N(!1)}})},se=s=>{u(s),b(!0)},te=()=>{if(!i)return;const s=new FormData;s.append("title",i.title||""),s.append("description",i.description||""),s.append("button_text",i.button_text||""),s.append("button_url",i.button_url||""),s.append("is_active",i.is_active?"1":"0"),s.append("sort_order",i.sort_order.toString()),i.newImage&&s.append("image",i.newImage),j.post(route("slider-items.update",i.id),s,{onSuccess:t=>{var a;const n=t;(a=n.props.slider)!=null&&a.items&&x(n.props.slider.items),b(!1),u(null)}})},ie=s=>{confirm("Bạn có chắc chắn muốn xóa mục này?")&&j.delete(route("slider-items.destroy",s),{onSuccess:t=>{x(n=>n.filter(a=>a.id!==s))}})},ne=s=>{T(s)},ae=s=>{k(s)},re=()=>{if(g!==null&&y!==null&&g!==y){const s=[...v],t=s[g];s.splice(g,1),s.splice(y,0,t);const n=s.map((a,ce)=>({...a,sort_order:ce+1}));x(n),j.post(route("slider-items.reorder"),{items:n.map(a=>({id:a.id,sort_order:a.sort_order}))},{preserveState:!0,preserveScroll:!0})}T(null),k(null)},le=s=>{var n;const t=((n=s.target.files)==null?void 0:n[0])||null;t&&i&&u({...i,newImage:t,image_url:URL.createObjectURL(t)})};return e.jsxs(me,{children:[e.jsx(de,{title:`Chỉnh sửa Slider: ${c.name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-5xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(h,{variant:"outline",size:"sm",asChild:!0,className:"mr-4",children:e.jsxs(oe,{href:route("sliders.index"),children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Quay lại"]})}),e.jsx(Ne,{title:`Chỉnh sửa: ${c.name}`,description:"Quản lý thông tin và các mục trong slider"})]}),e.jsxs(ve,{defaultValue:"info",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(fe,{children:[e.jsx(A,{value:"info",children:"Thông tin"}),e.jsxs(A,{value:"items",children:["Danh sách mục (",v.length,")"]})]}),e.jsxs(R,{open:X,onOpenChange:N,children:[e.jsx(ue,{asChild:!0,children:e.jsxs(h,{children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Thêm mục"]})}),e.jsxs(P,{children:[e.jsxs(U,{children:[e.jsx($,{children:"Thêm mục mới vào slider"}),e.jsx(B,{children:"Điền thông tin để thêm mục mới vào slider"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"new-title",children:"Tiêu đề"}),e.jsx(o,{id:"new-title",name:"title",value:l.title,onChange:_,placeholder:"Tiêu đề mục"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"new-description",children:"Mô tả"}),e.jsx(D,{id:"new-description",name:"description",value:l.description,onChange:_,placeholder:"Mô tả ngắn (tùy chọn)",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"new-button_text",children:"Nút"}),e.jsx(o,{id:"new-button_text",name:"button_text",value:l.button_text,onChange:_,placeholder:"Văn bản nút (tùy chọn)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"new-button_url",children:"Liên kết"}),e.jsx(o,{id:"new-button_url",name:"button_url",value:l.button_url,onChange:_,placeholder:"URL (tùy chọn)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"new-image",children:"Hình ảnh"}),e.jsx(o,{id:"new-image",type:"file",accept:"image/*",onChange:Z}),l.imagePreview&&e.jsx("div",{className:"mt-2 relative h-40 bg-muted rounded-md overflow-hidden",children:e.jsx("img",{src:l.imagePreview,alt:"Preview",className:"w-full h-full object-contain"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{htmlFor:"new-is_active",className:"cursor-pointer",children:"Kích hoạt"}),e.jsx(S,{id:"new-is_active",checked:l.is_active,onCheckedChange:Y})]})]}),e.jsxs(K,{children:[e.jsx(h,{variant:"outline",onClick:()=>N(!1),children:"Hủy"}),e.jsx(h,{onClick:ee,children:"Thêm mục"})]})]})]}),i&&e.jsx(R,{open:G,onOpenChange:b,children:e.jsxs(P,{children:[e.jsxs(U,{children:[e.jsx($,{children:"Chỉnh sửa mục"}),e.jsx(B,{children:"Cập nhật thông tin cho mục trong slider"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-title",children:"Tiêu đề"}),e.jsx(o,{id:"edit-title",value:i.title||"",onChange:s=>u({...i,title:s.target.value}),placeholder:"Tiêu đề mục"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-description",children:"Mô tả"}),e.jsx(D,{id:"edit-description",value:i.description||"",onChange:s=>u({...i,description:s.target.value}),placeholder:"Mô tả ngắn (tùy chọn)",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-button_text",children:"Nút"}),e.jsx(o,{id:"edit-button_text",value:i.button_text||"",onChange:s=>u({...i,button_text:s.target.value}),placeholder:"Văn bản nút (tùy chọn)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-button_url",children:"Liên kết"}),e.jsx(o,{id:"edit-button_url",value:i.button_url||"",onChange:s=>u({...i,button_url:s.target.value}),placeholder:"URL (tùy chọn)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-image",children:"Hình ảnh"}),e.jsx(o,{id:"edit-image",type:"file",accept:"image/*",onChange:le}),i.image_url&&e.jsx("div",{className:"mt-2 relative h-40 bg-muted rounded-md overflow-hidden",children:e.jsx("img",{src:i.image_url,alt:i.title||"Slider image",className:"w-full h-full object-contain"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{htmlFor:"edit-is_active",className:"cursor-pointer",children:"Kích hoạt"}),e.jsx(S,{id:"edit-is_active",checked:i.is_active,onCheckedChange:s=>u({...i,is_active:s})})]})]}),e.jsxs(K,{children:[e.jsx(h,{variant:"outline",onClick:()=>b(!1),children:"Hủy"}),e.jsx(h,{onClick:te,children:"Lưu thay đổi"})]})]})})]}),e.jsx(z,{value:"info",className:"space-y-6",children:e.jsx(E,{children:e.jsxs("form",{onSubmit:W,children:[e.jsxs(L,{children:[e.jsx(O,{children:"Thông tin slider"}),e.jsx(H,{children:"Chỉnh sửa thông tin cơ bản của slider"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"name",children:["Tên slider ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(o,{id:"name",name:"name",value:p.name,onChange:C,className:m.name?"border-destructive":"",required:!0}),m.name&&e.jsx("p",{className:"text-destructive text-sm",children:m.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"slug",children:"Slug"}),e.jsx(o,{id:"slug",name:"slug",value:p.slug,onChange:C,className:m.slug?"border-destructive":""}),m.slug&&e.jsx("p",{className:"text-destructive text-sm",children:m.slug}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Để trống để tự động tạo từ tên"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",children:"Mô tả"}),e.jsx(D,{id:"description",name:"description",value:p.description,onChange:C,className:m.description?"border-destructive":"",rows:4}),m.description&&e.jsx("p",{className:"text-destructive text-sm",children:m.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{htmlFor:"is_active",className:"cursor-pointer",children:"Kích hoạt"}),e.jsx(S,{id:"is_active",checked:p.is_active,onCheckedChange:J})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Slider sẽ ",p.is_active?"":"không"," được hiển thị trên trang web"]})]})]}),e.jsx(he,{className:"flex justify-end border-t pt-6",children:e.jsx(h,{type:"submit",disabled:F,children:F?"Đang lưu...":"Lưu thay đổi"})})]})})}),e.jsx(z,{value:"items",className:"space-y-6",children:e.jsxs(E,{children:[e.jsxs(L,{children:[e.jsx(O,{children:"Danh sách mục trong slider"}),e.jsx(H,{children:"Kéo và thả để thay đổi thứ tự hiển thị"})]}),e.jsx(M,{children:v.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("p",{className:"mb-4",children:"Slider này chưa có mục nào"}),e.jsxs(h,{onClick:()=>N(!0),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Thêm mục đầu tiên"]})]}):e.jsx("div",{className:"space-y-3",children:v.map((s,t)=>e.jsxs("div",{className:`flex items-center gap-4 border rounded-lg p-3 cursor-move ${g===t?"opacity-50 border-primary":""}`,draggable:!0,onDragStart:()=>ne(t),onDragEnter:()=>ae(t),onDragOver:n=>n.preventDefault(),onDragEnd:re,children:[e.jsx("div",{className:"h-16 w-16 bg-muted rounded-md overflow-hidden flex-shrink-0",children:e.jsx("img",{src:s.image_thumb_url,alt:s.title||"Slider image",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium truncate",children:s.title||"Không có tiêu đề"}),s.button_text&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Nút: ",s.button_text," → ",s.button_url||"#"]})]}),e.jsx(je,{variant:s.is_active?"default":"secondary",className:"ml-2",children:s.is_active?"Hiển thị":"Ẩn"})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground truncate mt-1",children:s.description})]}),e.jsxs(pe,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(_e,{className:"h-4 w-4"})]})}),e.jsxs(ge,{align:"end",children:[e.jsx(V,{onClick:()=>se(s),children:"Chỉnh sửa"}),e.jsx(V,{className:"text-destructive",onClick:()=>ie(s.id),children:"Xóa"})]})]})]},s.id))})})]})})]})]})})]})}export{Ge as default};
