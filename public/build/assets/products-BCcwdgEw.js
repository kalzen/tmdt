import{r as n,j as e,L as Y,$ as M,S as g}from"./app-DVolXm_H.js";import{F as Z}from"./frontend-layout-Dv_aMPNd.js";import{c as ee,B as d}from"./button-DbKjlMrn.js";import{C as se,d as ae}from"./card-BM4_Yqij.js";import{P as te}from"./pagination-YELyK-75.js";import{I as k}from"./input-BqT_-I7N.js";import{L as _}from"./label-BbBB_dkE.js";import{S as re}from"./slider-Cca1I4tj.js";import{S as w,a as C,b as F,c as A,d as i}from"./select-D0xov34E.js";import{C as P}from"./checkbox-CH4-Vrfq.js";import{S as le,J as ce,n as ne,X as $}from"./sonner-CEinsP_z.js";import{B as ie,a as oe,b as q,d as H,e as de}from"./breadcrumb-Co9X1bHK.js";import{S as J}from"./separator-DCz_B5cK.js";import{A as me,a as xe,b as he,c as ue}from"./accordion-BxedYJpA.js";import{S as pe}from"./search-CYjSE0ST.js";import"./tabs-DHy3rOEv.js";import"./index-_mtVRR73.js";import"./index-CW0FACpT.js";import"./index-C7NGfonP.js";import"./loader-circle-CD0wxyij.js";import"./navigation-menu-GfU3ezg7.js";import"./index-Bh82dGG3.js";import"./chevron-down-B2stwFhm.js";import"./badge-6e0qjOlb.js";import"./chevron-left-BpKklFH9.js";import"./chevron-right-C1IPqF67.js";import"./ellipsis-CgWpl1Pe.js";import"./index-BG5QGlun.js";import"./index-D6KtC3on.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],W=ee("Filter",je);function We({products:t,filters:a,parentCatalogues:O}){var R,z;const[X,u]=n.useState(!1),[f,N]=n.useState(a.search||""),[r,x]=n.useState([a.min_price||0,a.max_price||1e3]),[L,I]=n.useState(a.sort_by||"created_at"),[B,T]=n.useState(a.sort_direction||"desc"),[V,E]=n.useState(((R=a.per_page)==null?void 0:R.toString())||"20"),[c,l]=n.useState(!1),[p,v]=n.useState(((z=a.catalogue)==null?void 0:z.toString())||""),[o,b]=n.useState({inStock:a.in_stock==="1",outOfStock:a.out_of_stock==="1"}),G=s=>{s.preventDefault(),h()},h=()=>{l(!0);const s={};f&&(s.search=f),s.min_price=r[0].toString(),s.max_price=r[1].toString(),s.sort_by=L,s.sort_direction=B,s.per_page=V,p&&(s.catalogue=p),o.inStock&&!o.outOfStock?s.in_stock="1":!o.inStock&&o.outOfStock&&(s.out_of_stock="1"),g.get("/product",s,{preserveScroll:!0,preserveState:!0,only:["products","filters"],onSuccess:()=>{l(!1),u(!1)},onError:()=>{l(!1)}})},S=()=>{N(""),x([0,1e3]),I("created_at"),T("desc"),E("20"),v(""),b({inStock:!1,outOfStock:!1}),g.get("/product",{},{preserveScroll:!0,preserveState:!0,only:["products","filters"],onSuccess:()=>{l(!1),u(!1)}})},K=s=>{v(s===p?"":s)};return e.jsxs(Z,{children:[e.jsx(Y,{title:"Products - Marketplace"}),e.jsxs("div",{className:"container px-4 py-8 mx-auto",children:[e.jsx(ie,{className:"mb-6",children:e.jsxs(oe,{children:[e.jsx(q,{children:e.jsx(H,{href:"/",children:"Home"})}),e.jsx(de,{}),e.jsx(q,{children:e.jsx(H,{children:"Products"})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Products"}),e.jsxs("p",{className:"text-muted-foreground",children:[t.meta.total," products found"]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsx("form",{onSubmit:G,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(k,{type:"search",placeholder:"Search products...",className:"pr-10 w-full md:w-[250px]",value:f,onChange:s=>N(s.target.value)}),e.jsxs(d,{type:"submit",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Search"})]})]})}),e.jsxs(le,{open:X,onOpenChange:u,children:[e.jsx(ce,{asChild:!0,children:e.jsxs(d,{variant:"outline",className:"gap-2 md:hidden",children:[e.jsx(W,{className:"h-4 w-4"}),"Filters"]})}),e.jsx(ne,{side:"left",className:"w-[300px] sm:w-[350px]",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsx("div",{className:"space-y-6 flex-1 overflow-y-auto",children:D()}),e.jsxs("div",{className:"pt-4 border-t mt-auto",children:[e.jsx(d,{className:"w-full mb-2",onClick:h,disabled:c,children:c?"Applying...":"Apply Filters"}),e.jsx(d,{variant:"outline",className:"w-full",onClick:S,disabled:c,children:"Clear Filters"})]})]})})]}),e.jsxs(w,{value:L,onValueChange:s=>{I(s),setTimeout(()=>h(),0)},children:[e.jsx(C,{className:"w-[120px] md:w-[150px]",children:e.jsx(F,{placeholder:"Sort by"})}),e.jsxs(A,{children:[e.jsx(i,{value:"created_at",children:"Newest"}),e.jsx(i,{value:"price",children:"Price"}),e.jsx(i,{value:"name",children:"Name"})]})]}),e.jsxs(w,{value:B,onValueChange:s=>{T(s),setTimeout(()=>h(),0)},children:[e.jsx(C,{className:"w-[100px]",children:e.jsx(F,{placeholder:"Order"})}),e.jsxs(A,{children:[e.jsx(i,{value:"asc",children:"Ascending"}),e.jsx(i,{value:"desc",children:"Descending"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"hidden md:block w-[280px] shrink-0",children:e.jsxs("div",{className:"bg-muted/20 rounded-lg p-4 sticky top-24",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Filters"}),e.jsx(d,{variant:"ghost",size:"sm",className:"text-xs h-auto p-1",onClick:S,children:"Clear all"})]}),D(),e.jsx(d,{onClick:h,className:"w-full mt-4",disabled:c,children:c?"Applying...":"Apply Filters"})]})}),e.jsxs("div",{className:"flex-1",children:[Q()&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[a.search&&e.jsxs("div",{className:"bg-muted rounded-full px-3 py-1 text-sm flex items-center",children:[e.jsxs("span",{className:"mr-1",children:["Search: ",a.search]}),e.jsx("button",{onClick:()=>{N("");const s={...a,search:void 0};j(s)},className:"focus:outline-none",children:e.jsx($,{className:"h-3 w-3"})})]}),(a.min_price||a.max_price)&&e.jsxs("div",{className:"bg-muted rounded-full px-3 py-1 text-sm flex items-center",children:[e.jsxs("span",{className:"mr-1",children:["Price: $",a.min_price||0," - $",a.max_price||1e3]}),e.jsx("button",{onClick:()=>{x([0,1e3]);const s={...a,min_price:void 0,max_price:void 0};j(s)},className:"focus:outline-none",children:e.jsx($,{className:"h-3 w-3"})})]}),a.catalogue&&a.selectedCatalogueName&&e.jsxs("div",{className:"bg-muted rounded-full px-3 py-1 text-sm flex items-center",children:[e.jsxs("span",{className:"mr-1",children:["Category: ",a.selectedCatalogueName]}),e.jsx("button",{onClick:()=>{v("");const s={...a,catalogue:void 0};j(s)},className:"focus:outline-none",children:e.jsx($,{className:"h-3 w-3"})})]})]}),c&&e.jsxs("div",{className:"w-full py-12 text-center",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading products..."})]}),!c&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:t.data.map(s=>e.jsxs(se,{className:"group overflow-hidden",children:[e.jsxs("div",{className:"aspect-square relative overflow-hidden",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),s.discount_percentage>0&&e.jsxs("div",{className:"absolute top-2 left-2 bg-red-500 text-white text-xs px-2 py-1 rounded-md",children:["-",s.discount_percentage,"%"]})]}),e.jsxs(ae,{className:"p-4",children:[e.jsx(M,{href:`/product/${s.slug}`,className:"font-medium line-clamp-2 group-hover:text-primary transition-colors",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("div",{children:s.sale_price?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-bold text-primary",children:["$",s.sale_price.toFixed(2)]}),e.jsxs("span",{className:"text-xs text-muted-foreground line-through",children:["$",s.price.toFixed(2)]})]}):e.jsxs("span",{className:"font-bold text-primary",children:["$",s.price.toFixed(2)]})}),e.jsx(M,{href:`/store/${s.store.slug}`,className:"text-xs text-muted-foreground hover:text-primary transition-colors",children:s.store.name})]})]})]},s.id))}),!c&&t.data.length===0&&e.jsxs("div",{className:"text-center py-12 bg-muted/20 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No products found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Try adjusting your search or filter criteria"}),e.jsx(d,{onClick:S,children:"Clear All Filters"})]}),!c&&t.meta.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",t.meta.from,"-",t.meta.to," of ",t.meta.total," products"]}),e.jsx(te,{children:e.jsxs("div",{className:"flex items-center justify-center",children:[t.meta.current_page>1&&e.jsx("button",{onClick:()=>y(t.meta.current_page-1),className:"px-4 py-2 text-sm border rounded-l-md hover:bg-muted",children:"Previous"}),Array.from({length:t.meta.last_page},(s,m)=>m+1).filter(s=>s===1||s===t.meta.last_page||s>=t.meta.current_page-1&&s<=t.meta.current_page+1).map((s,m,U)=>m>0&&s>U[m-1]+1?e.jsx("span",{className:"px-4 py-2 text-sm border bg-background",children:"..."},`ellipsis-${s}`):e.jsx("button",{onClick:()=>y(s),className:`px-4 py-2 text-sm border ${s===t.meta.current_page?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"}`,children:s},s)),t.meta.current_page<t.meta.last_page&&e.jsx("button",{onClick:()=>y(t.meta.current_page+1),className:"px-4 py-2 text-sm border rounded-r-md hover:bg-muted",children:"Next"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show:"}),e.jsxs(w,{value:V,onValueChange:s=>{E(s);const m={...a,per_page:s};j(m)},children:[e.jsx(C,{className:"w-[70px]",children:e.jsx(F,{placeholder:"20"})}),e.jsxs(A,{children:[e.jsx(i,{value:"12",children:"12"}),e.jsx(i,{value:"20",children:"20"}),e.jsx(i,{value:"36",children:"36"}),e.jsx(i,{value:"48",children:"48"})]})]})]})]})]})]})]}),e.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-background border-t border-border shadow-lg z-50",children:e.jsxs(d,{onClick:()=>u(!0),className:"w-full",variant:"default",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Apply Filters"]})})]});function D(){return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Price Range"}),e.jsx("div",{className:"px-2",children:e.jsx(re,{value:r,max:1e3,step:10,onValueChange:s=>x(s)})}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("span",{className:"text-sm",children:["$",r[0]]}),e.jsxs("span",{className:"text-sm",children:["$",r[1]]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(k,{className:"h-8",type:"number",min:0,max:r[1],value:r[0],onChange:s=>x([parseInt(s.target.value)||0,r[1]])}),e.jsx("span",{children:"-"}),e.jsx(k,{className:"h-8",type:"number",min:r[0],max:1e3,value:r[1],onChange:s=>x([r[0],parseInt(s.target.value)||0])})]})]}),e.jsx(J,{}),e.jsx(me,{type:"multiple",className:"w-full",defaultValue:["categories"],children:e.jsxs(xe,{value:"categories",className:"border-none",children:[e.jsx(he,{className:"py-1",children:e.jsx("span",{className:"text-sm font-medium",children:"Categories"})}),e.jsx(ue,{children:e.jsxs("div",{className:"pl-2 space-y-2 max-h-screen overflow-y-auto pr-2",children:[O.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{id:`category-${s.id}`,checked:p===s.id.toString(),onCheckedChange:m=>K(s.id.toString())}),e.jsx(_,{htmlFor:`category-${s.id}`,className:"text-sm",children:s.name})]},s.id)),O.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No categories found"})]})})]})}),e.jsx(J,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Availability"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{id:"in-stock",checked:o.inStock,onCheckedChange:s=>b({...o,inStock:!!s})}),e.jsx(_,{htmlFor:"in-stock",className:"text-sm",children:"In Stock"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{id:"out-of-stock",checked:o.outOfStock,onCheckedChange:s=>b({...o,outOfStock:!!s})}),e.jsx(_,{htmlFor:"out-of-stock",className:"text-sm",children:"Out of Stock"})]})]})]})]})}function Q(){return!!(a.search||a.min_price||a.max_price||a.catalogue||a.store||a.in_stock||a.out_of_stock)}function y(s){l(!0),g.get("/product",{...a,page:s.toString()},{preserveScroll:!0,preserveState:!0,only:["products"],onSuccess:()=>l(!1),onError:()=>l(!1)})}function j(s){l(!0),g.get("/product",s,{preserveScroll:!0,preserveState:!0,only:["products","filters"],onSuccess:()=>l(!1),onError:()=>l(!1)})}}export{We as default};
